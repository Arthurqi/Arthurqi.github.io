(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-Story-StoryDetail"],{"0bfd":function(t,e,i){"use strict";i.r(e);var n=i("92ea"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(r);e["default"]=a.a},"0d67":function(t,e){var i={errorImg:null,filter:null,highlight:null,onText:null,entities:{quot:'"',apos:"'",semi:";",nbsp:" ",ensp:" ",emsp:" ",ndash:"–",mdash:"—",middot:"·",lsquo:"‘",rsquo:"’",ldquo:"“",rdquo:"”",bull:"•",hellip:"…"},blankChar:n(" , ,\t,\r,\n,\f"),boolAttrs:n("allowfullscreen,autoplay,autostart,controls,ignore,loop,muted"),blockTags:n("address,article,aside,body,caption,center,cite,footer,header,html,nav,pre,section"),ignoreTags:n("area,base,canvas,frame,iframe,input,link,map,meta,param,script,source,style,svg,textarea,title,track,wbr"),richOnlyTags:n("a,colgroup,fieldset,legend"),selfClosingTags:n("area,base,br,col,circle,ellipse,embed,frame,hr,img,input,line,link,meta,param,path,polygon,rect,source,track,use,wbr"),trustTags:n("a,abbr,ad,audio,b,blockquote,br,code,col,colgroup,dd,del,dl,dt,div,em,fieldset,h1,h2,h3,h4,h5,h6,hr,i,img,ins,label,legend,li,ol,p,q,source,span,strong,sub,sup,table,tbody,td,tfoot,th,thead,tr,title,ul,video"),userAgentStyles:{address:"font-style:italic",big:"display:inline;font-size:1.2em",blockquote:"background-color:#f6f6f6;border-left:3px solid #dbdbdb;color:#6c6c6c;padding:5px 0 5px 10px",caption:"display:table-caption;text-align:center",center:"text-align:center",cite:"font-style:italic",dd:"margin-left:40px",mark:"background-color:yellow",pre:"font-family:monospace;white-space:pre;overflow:scroll",s:"text-decoration:line-through",small:"display:inline;font-size:0.8em",u:"text-decoration:underline"}};function n(t){for(var e=Object.create(null),i=t.split(","),n=i.length;n--;)e[i[n]]=!0;return e}t.exports=i},"1a11":function(t,e,i){var n=i("bd1c");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("39ae5949",n,!0,{sourceMap:!1,shadowMode:!1})},"54f8":function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var i="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=(0,n.default)(t))||e&&t&&"number"===typeof t.length){i&&(t=i);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){l=!0,o=t},f:function(){try{s||null==i["return"]||i["return"]()}finally{if(l)throw o}}}},i("a4d3"),i("e01a"),i("d3b7"),i("d28b"),i("3ca3"),i("ddb0"),i("d9e2"),i("d401");var n=function(t){return t&&t.__esModule?t:{default:t}}(i("dde1"))},"5fc6":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return n}));var n={uParse:i("7de8").default,uIcon:i("d3dc").default},a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.dispdata?i("v-uni-view",{staticClass:"common-detail pd30"},[i("v-uni-view",{staticClass:"detail-title"},[t._v(t._s(t.dispdata.title))]),i("v-uni-view",{staticClass:"infos a-flex"},[i("v-uni-view",{staticClass:"numbers"},[i("v-uni-text",[t._v("字数：")]),i("v-uni-text",[t._v(t._s(t.dispdata.length))])],1),i("v-uni-view",{staticClass:"time"},[i("v-uni-text",[t._v("阅读时长：")]),i("v-uni-text",[t._v(t._s(t.dispdata.readTime))])],1)],1),i("v-uni-view",{staticClass:"content"},[i("u-parse",{attrs:{html:t.dispdata.content}})],1),i("v-uni-view",{staticClass:"fixed-play a-flex a-flex-between a-flex-col-center"},[i("v-uni-view",{staticClass:"title"},[t._v(t._s(t.dispdata.title))]),i("v-uni-view",{staticClass:"btns a-flex a-flex-col-center"},[t.audio.isPlay?i("u-icon",{attrs:{name:"pause-circle-fill",color:"#fff",size:"70"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.pauseAudio.apply(void 0,arguments)}}}):i("u-icon",{attrs:{name:"play-circle-fill",color:"#fff",size:"70"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.playAudio.apply(void 0,arguments)}}})],1)],1)],1):t._e()},r=[]},"79b1":function(t,e,i){"use strict";var n=i("8598"),a=i.n(n);a.a},"7de8":function(t,e,i){"use strict";i.r(e);var n=i("eecd"),a=i("842b");for(var r in a)["default"].indexOf(r)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(r);i("79b1");var o=i("f0c5"),s=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"5189efcc",null,!1,n["a"],void 0);e["default"]=s.exports},"842b":function(t,e,i){"use strict";i.r(e);var n=i("ffd9"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(r);e["default"]=a.a},8598:function(t,e,i){var n=i("e221");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("127f5746",n,!0,{sourceMap:!1,shadowMode:!1})},"92ea":function(t,e,i){"use strict";i("7a82");var n=i("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("d3b7"),i("159b");var a=n(i("f07e")),r=n(i("c964")),o=i("02a6"),s=n(i("768c")),l=n(i("0ede")),c={data:function(){return{dispdata:null,audio:null,audioResult:null,currentPlay:0}},watch:{audio:{deep:!0,handler:function(t){}}},onLoad:function(t){var e=this,i=t.storyId;uni.$on("ended",(function(){console.log("ended"),e.currentPlay++,e.playAudio()})),this.audio=new l.default,this.getStoryDetail(i)},methods:{getStoryDetail:function(t){var e=this;return(0,r.default)((0,a.default)().mark((function i(){var n;return(0,a.default)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,(0,o.getStoryDetail)({story_id:t});case 2:if(n=i.sent,1!=n.code){i.next=12;break}return e.dispdata=n.data,uni.setNavigationBarTitle({title:e.dispdata.title}),i.next=8,s.default.text2audio(e.dispdata.content);case 8:e.audioResult=i.sent,e.audioResult.forEach((function(t){t.isPlaying=!1})),i.next=13;break;case 12:s.default.toast(n.msg);case 13:case"end":return i.stop()}}),i)})))()},playAudio:function(){var t=this;this.audioResult.forEach((function(e,i){t.currentPlay==i?e.isPlaying=!0:e.isPlaying=!1}));var e=this.audioResult[this.currentPlay];this.audio.setSrc(e.filename),this.audio.play()},pauseAudio:function(){this.audio.pause()}},onUnload:function(){this.audio.destroy()},onHide:function(){this.audio.destroy()}};e.default=c},bd1c:function(t,e,i){var n=i("24fb");e=n(!1),e.push([t.i,".pd30[data-v-2feff33e]{padding:%?30?%}.mt20[data-v-2feff33e]{margin-top:%?20?%}.a-flex[data-v-2feff33e]{display:flex;align-items:center}.a-flex-wrap[data-v-2feff33e]{flex-wrap:wrap}.a-flex-column[data-v-2feff33e]{flex-direction:column}.a-flex-col-center[data-v-2feff33e]{justify-content:center}.a-flex-between[data-v-2feff33e]{justify-content:space-between}.a-flex-around[data-v-2feff33e]{justify-content:space-around}.a-flex1[data-v-2feff33e]{flex:1}.red[data-v-2feff33e]{color:red}.common-detail[data-v-2feff33e]{padding-bottom:%?150?%}.common-detail .detail-title[data-v-2feff33e]{font-size:%?36?%;font-weight:700}.common-detail .infos[data-v-2feff33e]{font-size:%?24?%;color:#999;margin:%?20?% 0 %?30?%}.common-detail .infos .time[data-v-2feff33e]{margin-left:%?30?%}.common-detail .content[data-v-2feff33e]{line-height:3em;font-size:%?32?%}.common-detail .fixed-play[data-v-2feff33e]{position:fixed;bottom:0;left:0;right:0;height:%?140?%;background:rgba(136,183,107,.6);-webkit-backdrop-filter:blur(%?8?%);backdrop-filter:blur(%?8?%);padding:0 %?30?%;color:#000;font-size:%?30?%}.common-detail .fixed-play .title[data-v-2feff33e]{width:calc(100vw - %?170?%);text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.common-detail .fixed-play .btns[data-v-2feff33e]{flex:0 0 %?100?%;width:%?100?%;height:%?100?%}",""]),t.exports=e},e221:function(t,e,i){var n=i("24fb");e=n(!1),e.push([t.i,"@-webkit-keyframes _show-data-v-5189efcc{0%{opacity:0}100%{opacity:1}}@keyframes _show-data-v-5189efcc{0%{opacity:0}100%{opacity:1}}\n\n\n\n",""]),t.exports=e},e716:function(t,e,i){"use strict";i.r(e);var n=i("5fc6"),a=i("0bfd");for(var r in a)["default"].indexOf(r)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(r);i("fa25");var o=i("f0c5"),s=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"2feff33e",null,!1,n["a"],void 0);e["default"]=s.exports},eecd:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){}));var n=function(){var t=this.$createElement,e=this._self._c||t;return e("v-uni-view",[this.nodes.length?this._e():this._t("default"),e("v-uni-view",{style:this.showAm+(this.selectable?";user-select:text;-webkit-user-select:text":""),attrs:{id:"_top"}},[e("div",{attrs:{id:"rtf"+this.uid}})])],2)},a=[]},fa25:function(t,e,i){"use strict";var n=i("1a11"),a=i.n(n);a.a},ffd9:function(t,e,i){"use strict";i("7a82");var n=i("ee27").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("54f8"));i("c975"),i("caad6"),i("2532"),i("ac1f"),i("466d"),i("841c"),i("5319"),i("e25e"),i("14d9"),i("99af"),i("acd8");var r=uni.getSystemInfoSync(),o=r.windowWidth,s=(r.platform,i("0d67")),l={name:"parser",data:function(){return{uid:this._uid,showAm:"",nodes:[]}},props:{html:String,autopause:{type:Boolean,default:!0},autoscroll:Boolean,autosetTitle:{type:Boolean,default:!0},domain:String,lazyLoad:Boolean,selectable:Boolean,tagStyle:Object,showWithAnimation:Boolean,useAnchor:Boolean},watch:{html:function(t){this.setContent(t)}},created:function(){this.imgList=[],this.imgList.each=function(t){for(var e=0,i=this.length;e<i;e++)this.setItem(e,t(this[e],e,this))},this.imgList.setItem=function(t,e){if(void 0!=t&&e){if(0==e.indexOf("http")&&this.includes(e)){for(var i,n=e.split("://")[0],a=n.length;i=e[a];a++){if("/"==i&&"/"!=e[a-1]&&"/"!=e[a+1])break;n+=Math.random()>.5?i.toUpperCase():i}return n+=e.substr(a),this[t]=n}if(this[t]=e,e.includes("data:image")){var r=e.match(/data:image\/(\S+?);(\S+?),(.+)/);if(!r)return}}}},mounted:function(){this.document=document.getElementById("rtf"+this._uid),this.html&&this.setContent(this.html)},beforeDestroy:function(){this._observer&&this._observer.disconnect(),this.imgList.each((function(t){})),clearInterval(this._timer)},methods:{setContent:function(t,e){var i=this;if(t){var n=document.createElement("div");e?this.rtf?this.rtf.appendChild(n):this.rtf=n:(this.rtf&&this.rtf.parentNode.removeChild(this.rtf),this.rtf=n),n.innerHTML=this._handleHtml(t,e);for(var r,l=this.rtf.getElementsByTagName("style"),c=0;r=l[c++];)r.innerHTML=r.innerHTML.replace(/body/g,"#rtf"+this._uid),r.setAttribute("scoped","true");!this._observer&&this.lazyLoad&&IntersectionObserver&&(this._observer=new IntersectionObserver((function(t){for(var e,n=0;e=t[n++];)e.isIntersecting&&(e.target.src=e.target.getAttribute("data-src"),e.target.removeAttribute("data-src"),i._observer.unobserve(e.target))}),{rootMargin:"500px 0px 500px 0px"}));var f=this,d=this.rtf.getElementsByTagName("title");d.length&&this.autosetTitle&&uni.setNavigationBarTitle({title:d[0].innerText});var u=function(t){var e=t.getAttribute("src");i.domain&&e&&("/"==e[0]?"/"==e[1]?t.src=(i.domain.includes("://")?i.domain.split("://")[0]:"")+":"+e:t.src=i.domain+e:e.includes("://")||0==e.indexOf("data:")||(t.src=i.domain+"/"+e))};this.imgList.length=0;for(var h,v=this.rtf.getElementsByTagName("img"),p=0,m=0;h=v[p];p++)parseInt(h.style.width||h.getAttribute("width"))>o&&(h.style.height="auto"),u(h),h.hasAttribute("ignore")||"A"==h.parentElement.nodeName||(h.i=m++,f.imgList.push(h.getAttribute("original-src")||h.src||h.getAttribute("data-src")),h.onclick=function(t){t.stopPropagation();var e=!0;this.ignore=function(){return e=!1},f.$emit("imgtap",this),e&&uni.previewImage({current:this.i,urls:f.imgList})}),h.onerror=function(){s.errorImg&&(f.imgList[this.i]=this.src=s.errorImg),f.$emit("error",{source:"img",target:this})},f.lazyLoad&&this._observer&&h.src&&0!=h.i&&(h.setAttribute("data-src",h.src),h.removeAttribute("src"),this._observer.observe(h));var g,b=this.rtf.getElementsByTagName("a"),y=(0,a.default)(b);try{for(y.s();!(g=y.n()).done;){var x=g.value;x.onclick=function(t){t.stopPropagation();var e=!0,i=this.getAttribute("href");if(f.$emit("linkpress",{href:i,ignore:function(){return e=!1}}),e&&i)if("#"==i[0])f.useAnchor&&f.navigateTo({id:i.substr(1)});else{if(0==i.indexOf("http")||0==i.indexOf("//"))return!0;uni.navigateTo({url:i})}return!1}}}catch(P){y.e(P)}finally{y.f()}var w=this.rtf.getElementsByTagName("video");f.videoContexts=w;for(var _,T=0;_=w[T++];)u(_),_.style.maxWidth="100%",_.onerror=function(){f.$emit("error",{source:"video",target:this})},_.onplay=function(){if(f.autopause)for(var t,e=0;t=f.videoContexts[e++];)t!=this&&t.pause()};var A,k,C=this.rtf.getElementsByTagName("audio"),S=(0,a.default)(C);try{for(S.s();!(A=S.n()).done;){var I=A.value;u(I),I.onerror=function(){f.$emit("error",{source:"audio",target:this})}}}catch(P){S.e(P)}finally{S.f()}if(this.autoscroll){var O,B=this.rtf.getElementsByTagName("table"),E=(0,a.default)(B);try{for(E.s();!(O=E.n()).done;){var L=O.value,M=document.createElement("div");M.style.overflow="scroll",L.parentNode.replaceChild(M,L),M.appendChild(L)}}catch(P){E.e(P)}finally{E.f()}}e||this.document.appendChild(this.rtf),this.$nextTick((function(){i.nodes=[1],i.$emit("load")})),setTimeout((function(){return i.showAm=""}),500),clearInterval(this._timer),this._timer=setInterval((function(){i.rect=i.rtf.getBoundingClientRect(),i.rect.height==k&&(i.$emit("ready",i.rect),clearInterval(i._timer)),k=i.rect.height}),350),this.showWithAnimation&&!e&&(this.showAm="animation:_show .5s")}else this.rtf&&!e&&this.rtf.parentNode.removeChild(this.rtf)},getText:function(){arguments.length>0&&void 0!==arguments[0]||this.nodes;var t="";return t=this.rtf.innerText,t},in:function(t){t.page&&t.selector&&t.scrollTop&&(this._in=t)},navigateTo:function(t){var e=this;if(!this.useAnchor)return t.fail&&t.fail("Anchor is disabled");var i=uni.createSelectorQuery().in(this._in?this._in.page:this).select((this._in?this._in.selector:"#_top")+(t.id?"".concat(" ","#").concat(t.id,",").concat(this._in?this._in.selector:"#_top").concat(" ",".").concat(t.id):"")).boundingClientRect();this._in?i.select(this._in.selector).scrollOffset().select(this._in.selector).boundingClientRect():i.selectViewport().scrollOffset(),i.exec((function(i){if(!i[0])return t.fail&&t.fail("Label not found");var n=i[1].scrollTop+i[0].top-(i[2]?i[2].top:0)+(t.offset||0);e._in?e._in.page[e._in.scrollTop]=n:uni.pageScrollTo({scrollTop:n,duration:300}),t.success&&t.success()}))},getVideoContext:function(t){if(!t)return this.videoContexts;for(var e=this.videoContexts.length;e--;)if(this.videoContexts[e].id==t)return this.videoContexts[e]},_handleHtml:function(t,e){if(!e){var i="<style scoped>@keyframes _show{0%{opacity:0}100%{opacity:1}}img{max-width:100%}";for(var n in s.userAgentStyles)i+="".concat(n,"{").concat(s.userAgentStyles[n],"}");for(n in this.tagStyle)i+="".concat(n,"{").concat(this.tagStyle[n],"}");i+="</style>",t=i+t}return t.includes("rpx")&&(t=t.replace(/[0-9.]+\s*rpx/g,(function(t){return parseFloat(t)*o/750+"px"}))),t}}};e.default=l}}]);